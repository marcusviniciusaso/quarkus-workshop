{"id":"1478880","content":"package org.springdoc.webmvc.ui;\n\nimport java.util.Map;\nimport java.util.function.BiConsumer;\nimport javax.servlet.http.HttpServletRequest;\nimport org.apache.commons.lang3.StringUtils;\nimport org.springdoc.core.SpringDocConfigProperties;\nimport org.springdoc.core.SwaggerUiConfigParameters;\nimport org.springdoc.core.SwaggerUiConfigProperties;\nimport org.springdoc.ui.AbstractSwaggerWelcome;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.http.ResponseEntity.BodyBuilder;\nimport org.springframework.web.servlet.support.ServletUriComponentsBuilder;\nimport org.springframework.web.util.UriComponentsBuilder;\n\npublic abstract class SwaggerWelcomeCommon extends AbstractSwaggerWelcome {\n   public SwaggerWelcomeCommon(SwaggerUiConfigProperties swaggerUiConfig, SpringDocConfigProperties springDocConfigProperties, SwaggerUiConfigParameters swaggerUiConfigParameters) {\n      super(swaggerUiConfig, springDocConfigProperties, swaggerUiConfigParameters);\n   }\n\n   protected ResponseEntity<Void> redirectToUi(HttpServletRequest request) {\n      this.buildFromCurrentContextPath(request);\n      String sbUrl = this.contextPath + this.swaggerUiConfigParameters.getUiRootPath() + this.getSwaggerUiUrl();\n      UriComponentsBuilder uriBuilder = this.getUriComponentsBuilder(sbUrl);\n      request.getParameterMap().forEach(uriBuilder::queryParam);\n      return ((BodyBuilder)ResponseEntity.status(HttpStatus.FOUND).location(uriBuilder.build().encode().toUri())).build();\n   }\n\n   protected Map<String, Object> openapiJson(HttpServletRequest request) {\n      this.buildFromCurrentContextPath(request);\n      return this.swaggerUiConfigParameters.getConfigParameters();\n   }\n\n   protected void calculateOauth2RedirectUrl(UriComponentsBuilder uriComponentsBuilder) {\n      if (StringUtils.isBlank(this.swaggerUiConfig.getOauth2RedirectUrl()) || !this.swaggerUiConfigParameters.isValidUrl(this.swaggerUiConfig.getOauth2RedirectUrl())) {\n         this.swaggerUiConfigParameters.setOauth2RedirectUrl(uriComponentsBuilder.path(this.swaggerUiConfigParameters.getUiRootPath()).path(this.getOauth2RedirectUrl()).build().toString());\n      }\n\n   }\n\n   void buildFromCurrentContextPath(HttpServletRequest request) {\n      super.init();\n      this.contextPath = request.getContextPath();\n      this.buildConfigUrl(ServletUriComponentsBuilder.fromCurrentContextPath());\n   }\n}\n"}